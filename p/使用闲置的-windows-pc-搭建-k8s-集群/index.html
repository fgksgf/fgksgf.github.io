<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Set up a k8s cluster with Windows PCs"><title>使用闲置的 Windows PC 搭建 k8s 集群</title><link rel=canonical href=https://fgksgf.github.io/p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/><link rel=stylesheet href=/scss/style.min.a904b2fc7ac9eaf2ba5a34af7a944ebfc5ce44f265b6bb5d6ac36e276322775d.css><meta property="og:title" content="使用闲置的 Windows PC 搭建 k8s 集群"><meta property="og:description" content="Set up a k8s cluster with Windows PCs"><meta property="og:url" content="https://fgksgf.github.io/p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/"><meta property="og:site_name" content="Hoshea's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="kubernetes"><meta property="article:published_time" content="2022-03-11T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-11T00:00:00+00:00"><meta name=twitter:title content="使用闲置的 Windows PC 搭建 k8s 集群"><meta name=twitter:description content="Set up a k8s cluster with Windows PCs"><link rel="shortcut icon" href=img/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-118341733-1','auto');ga('send','pageview');}</script></head><body class=article-page><script>(function(){const colorSchemeKey='StackColorScheme';if(!localStorage.getItem(colorSchemeKey)){localStorage.setItem(colorSchemeKey,"auto");}})();</script><script>(function(){const colorSchemeKey='StackColorScheme';const colorSchemeItem=localStorage.getItem(colorSchemeKey);const supportDarkMode=window.matchMedia('(prefers-color-scheme: dark)').matches===true;if(colorSchemeItem=='dark'||colorSchemeItem==='auto'&&supportDarkMode){document.documentElement.dataset.scheme='dark';}else{document.documentElement.dataset.scheme='light';}})();</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu3365246986d30a879bdaae7fb3f0ebf6_1027034_300x0_resize_box_2.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Hoshea's Blog</a></h1><h2 class=site-description>Do something today that your future self will thank you for.</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/archives><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/notes/>Notes</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/>使用闲置的 Windows PC 搭建 k8s 集群</a></h2><h3 class=article-subtitle>Set up a k8s cluster with Windows PCs</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Mar 11, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><h2 id=背景>背景</h2><p>手边有几台闲置的 Windows 台式机，于是准备充分利用一下这些闲置的计算资源，使用 kubeadm 搭建一个最新版本的 k8s 集群用于自己学习和研究。</p><p>这几台 PC 在一个局域网内可以互相连同和访问公网，但没有公网 IP。其配置如下，PC 1 用来作主节点，其他两台作为工作节点。</p><div class=table-wrapper><table><thead><tr><th style=text-align:center></th><th>OS</th><th style=text-align:center>配置</th><th style=text-align:center>IP</th><th style=text-align:center>VM 配置</th><th style=text-align:center>VM IP</th><th style=text-align:center>VM Hostname</th></tr></thead><tbody><tr><td style=text-align:center>PC 1</td><td>Win 10</td><td style=text-align:center>4核8G</td><td style=text-align:center>192.168.2.38</td><td style=text-align:center>2核4G</td><td style=text-align:center>192.168.2.80</td><td style=text-align:center>master</td></tr><tr><td style=text-align:center>PC 2</td><td>Win 10</td><td style=text-align:center>4核24G</td><td style=text-align:center>192.168.2.24</td><td style=text-align:center>3核16G</td><td style=text-align:center>192.168.2.84</td><td style=text-align:center>worker-4c16g</td></tr><tr><td style=text-align:center>PC 3</td><td>Win 10</td><td style=text-align:center>4核16G</td><td style=text-align:center>192.168.2.51</td><td style=text-align:center>3核8G</td><td style=text-align:center>192.168.2.81</td><td style=text-align:center>k8s-worker</td></tr></tbody></table></div><h2 id=准备>准备</h2><p>首先在所有 PC 上安装好 <a class=link href=https://www.virtualbox.org/wiki/Downloads target=_blank rel=noopener>VirtualBox</a>，在 PC 1（主节点）上下载好 <a class=link href=https://ubuntu.com/download/server target=_blank rel=noopener>Ubuntu Server 20.04</a> 的镜像，安装虚拟机，具体过程可参考<a class=link href=https://github.com/cncamp/101/blob/master/k8s-install/k8s-by-kubeadm/install-ubuntu-on-virtualbox.pdf target=_blank rel=noopener>这里</a>，其中有几个需要注意的地方：</p><ul><li><p>确保虚拟机分配的 CPU 数量大于 2 但小于宿主机实际的 CPU 数量，否则 kubeadm 初始化的时候会报错</p></li><li><p>30G 硬盘，4G 以上内存</p></li><li><p>安装过程会有个安装软件/工具的页面，除了 OpenSSH Server 以外<strong>其他都不安装</strong>，<strong>特别是 Docker，不要勾选安装</strong>（因为会使用 <a class=link href=https://cn.ubuntu.com/blog/what-is-snap-application target=_blank rel=noopener>snap</a> 进行安装导致 kubelet 检测不到 Docker 服务）</p></li></ul><h2 id=主节点>主节点</h2><p>首先在主节点安装好所需的软件，然后再将该虚拟机复制到其他 PC 上，从而省去重复安装和配置的过程。</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell><span class=c1># 设置 hostname，用于区分不同的虚拟机</span>
sudo hostnamectl set-hostname master --static
</code></pre></div><h3 id=软件安装>软件安装</h3><p>使用阿里云的镜像仓库，避免因网络问题无法拉取镜像。</p><h4 id=docker>Docker</h4><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>curl -fsSL https://get.docker.com <span class=p>|</span> sudo sh -s -- --mirror Aliyun
sudo usermod -aG docker <span class=nv>$USER</span>
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <span class=s>&lt;&lt;-&#39;EOF&#39;
</span><span class=s>{
</span><span class=s>  &#34;exec-opts&#34;: [&#34;native.cgroupdriver=systemd&#34;],
</span><span class=s>  &#34;log-driver&#34;: &#34;json-file&#34;,
</span><span class=s>  &#34;log-opts&#34;: {
</span><span class=s>    &#34;max-size&#34;: &#34;100m&#34;
</span><span class=s>  },
</span><span class=s>  &#34;storage-driver&#34;: &#34;overlay2&#34;,
</span><span class=s>  &#34;registry-mirrors&#34;: [&#34;https://bdbdr6uo.mirror.aliyuncs.com&#34;]
</span><span class=s>}
</span><span class=s>EOF</span>
sudo systemctl daemon-reload
sudo systemctl restart docker
</code></pre></div><h4 id=k8s>K8s</h4><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 添加并信任APT证书</span>
curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg <span class=p>|</span> sudo apt-key add -

<span class=c1># 添加源地址</span>
add-apt-repository <span class=s2>&#34;deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main&#34;</span>

sudo apt update <span class=o>&amp;&amp;</span> apt install -y kubelet kubeadm kubectl
</code></pre></div><h3 id=复制虚拟机>复制虚拟机</h3><p>在 VitrualBox 界面将虚拟机关机后，右键复制，选择保存的路径，需要注意：</p><ul><li><p><strong>设置重新生成 MAC 地址</strong></p></li><li><p>不保留硬件 UUID</p></li><li><p>完全复制</p></li></ul><p><img src=/p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/screenshot-1.png width=581 height=496 srcset="/p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/screenshot-1_hub3248eff56d3833c4cb41b8aebeba2e9_181540_480x0_resize_box_2.png 480w, /p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/screenshot-1_hub3248eff56d3833c4cb41b8aebeba2e9_181540_1024x0_resize_box_2.png 1024w" loading=lazy class=gallery-image data-flex-grow=117 data-flex-basis=281px>
<img src=/p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/screenshot-2.png width=579 height=396 srcset="/p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/screenshot-2_hu3ff4c1d45e77a359f3d4dfa5274206dd_134521_480x0_resize_box_2.png 480w, /p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/screenshot-2_hu3ff4c1d45e77a359f3d4dfa5274206dd_134521_1024x0_resize_box_2.png 1024w" loading=lazy class=gallery-image data-flex-grow=146 data-flex-basis=350px></p><p>然后通过 U 盘或移动硬盘将复制的虚拟机拷贝到另外两台电脑上，打开 VirtualBox，点击注册，选择复制的虚拟机文件。</p><p><img src=/p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/screenshot-3.png width=1920 height=1112 srcset="/p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/screenshot-3_hu549c367b379192130df9b1c0d4b0b6b5_604144_480x0_resize_box_2.png 480w, /p/%E4%BD%BF%E7%94%A8%E9%97%B2%E7%BD%AE%E7%9A%84-windows-pc-%E6%90%AD%E5%BB%BA-k8s-%E9%9B%86%E7%BE%A4/screenshot-3_hu549c367b379192130df9b1c0d4b0b6b5_604144_1024x0_resize_box_2.png 1024w" loading=lazy class=gallery-image data-flex-grow=172 data-flex-basis=414px></p><h2 id=网络配置>网络配置</h2><p>在虚拟机关机状态下，在虚拟机设置中将网络设置为<strong>桥接网络</strong>，相当于在局域网中虚拟出一台新主机，然后启动虚拟机，<strong>切换到 root 用户，接下来的操作都用 root 进行操作</strong>。</p><p>通过命令<code>vim /etc/netplan/00-installer-config.yaml</code>配置静态 IP 地址：</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>network</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>ethernets</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>enp0s3</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>dhcp4</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w> </span><span class=c># 关闭动态分配 IP</span><span class=w>
</span><span class=w>      </span><span class=nt>addresses</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=m>192.168.2.81</span><span class=l>/24]</span><span class=w> </span><span class=c># 设置一个和宿主机同网段的 IP，并确保该 IP 未被占用</span><span class=w>
</span><span class=w>      </span><span class=nt>gateway4</span><span class=p>:</span><span class=w> </span><span class=m>192.168.2.1</span><span class=w> </span><span class=c># 与宿主机一致</span><span class=w>
</span><span class=w>      </span><span class=nt>nameservers</span><span class=p>:</span><span class=w>
</span><span class=w>              </span><span class=nt>addresses</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=m>8.8.8.8</span><span class=p>,</span><span class=w> </span><span class=m>8.8.4.4</span><span class=p>]</span><span class=w> </span><span class=c># 与宿主机一致</span><span class=w>
</span><span class=w>  </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></code></pre></div><p>修改完成后保存，执行：<code>netplan apply</code>，然后测试虚拟机之间是否能够 ping 通以及访问外网。</p><h2 id=集群初始化>集群初始化</h2><p>在主节点上，以 root 用户执行：</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>kubeadm init --image-repository<span class=o>=</span><span class=s1>&#39;registry.cn-hangzhou.aliyuncs.com/google_containers&#39;</span>

<span class=c1># 安装网络插件</span>
kubectl apply -f <span class=s2>&#34;https://cloud.weave.works/k8s/net?k8s-version=</span><span class=k>$(</span>kubectl version <span class=p>|</span> base64 <span class=p>|</span> tr -d <span class=s1>&#39;\n&#39;</span><span class=k>)</span><span class=s2>&#34;</span>
</code></pre></div><p><code>kubeadm init</code>成功后会显示类似信息，复制用于工作节点加入集群：</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>kubeadm join 192.168.2.80:6443 --token szeip3.tm5ji5ajpa6xfk64 <span class=se>\
</span><span class=se></span>        --discovery-token-ca-cert-hash sha256:f256bb87bb7d80eca7e620562a1adcbadbdc0ecd799da659403d193cb3dc3037
</code></pre></div><p>其中的 token 24 小时后过期，过期后可通过<code>kubeadm token create --print-join-command</code>再次获取上面的信息。</p><p>在工作节点以 root 执行前面复制的 <code>kubeadm join</code> 命令即可加入集群。</p><p>在主节点上查看节点：</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=nb>export</span> <span class=nv>KUBECONFIG</span><span class=o>=</span>/etc/kubernetes/admin.conf
kubectl get nodes
</code></pre></div><p>应该可以看到三个节点，且都是<code>Ready</code>状态，然后只有主节点有 role 字段，两个工作节点没有，可以通过以下命令来设置：</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>kubectl label node &lt;node name&gt; node-role.kubernetes.io/worker<span class=o>=</span>worker
</code></pre></div><p>使用<code>kubectl get pod -n kube-system</code>查看核心组件的运行情况。</p><h2 id=ssh-配置可选>SSH 配置（可选）</h2><p>为了便于 SSH 到各 k8s 节点上，可以进行以下配置：</p><h3 id=免密码登陆>免密码登陆</h3><p>在各虚拟机上通过<code>sudo vim /etc/ssh/sshd_config</code>编辑 sshd 的配置文件，允许 root 登陆和使用公钥认证:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>PermitRootLogin yes
PubkeyAuthentication yes
</code></pre></div><p>保存后重启 sshd 服务：<code>service sshd restart</code></p><p>在个人 PC 上：</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 将公钥复制到虚拟机上</span>
scp ~/.ssh/id_rsa.pub root@192.168.2.81:~/.ssh/
</code></pre></div><p>在虚拟机上：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>cat ~/.ssh/id_rsa.pub &gt;&gt; authorized_keys
</code></pre></div><h3 id=快捷连接>快捷连接</h3><p>在个人 PC 上给 ssh 的虚拟机设置别名，从而实现执行<code>ssh master</code>就能连接虚拟机，而无需记忆 IP 地址：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>vim ~/.ssh/config

Host master
    user root
    hostname 192.168.2.80
    port 22
    IdentityFile /Users/hoshea/.ssh/id_rsa

Host worker1
    user root
    hostname 192.168.2.84
    port 22
    IdentityFile /Users/hoshea/.ssh/id_rsa

Host worker2
    user root
    hostname 192.168.2.81
    port 22
    IdentityFile /Users/hoshea/.ssh/id_rsa
</code></pre></div><h2 id=参考>参考</h2><ul><li><a class=link href=https://github.com/islishude/blog/issues/212 target=_blank rel=noopener>k8s 国内源安装备忘清单 · Issue #212 · islishude/blog · GitHub</a></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/kubernetes/>kubernetes</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-ND 4.0</span></section></footer></article><aside class=related-contents--wrapper><h2 class=section-title>Related contents</h2><div class=related-contents><div class="flex article-list--tile"><article><a href=/p/%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%BA%93neo4j%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/><div class=article-details><h2 class=article-title>图数据库Neo4j学习笔记</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=fgksgf/blog-comment-system issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(theme){let utterances=document.querySelector('.utterances iframe');if(utterances){utterances.contentWindow.postMessage({type:'set-theme',theme:`github-${theme}`},'https://utteranc.es');}}
addEventListener('message',event=>{if(event.origin!=='https://utteranc.es')return;setUtterancesTheme(document.documentElement.dataset.scheme)});window.addEventListener('onColorSchemeChange',(e)=>{setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 Hoshea's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.10.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#背景>背景</a></li><li><a href=#准备>准备</a></li><li><a href=#主节点>主节点</a><ol><li><a href=#软件安装>软件安装</a><ol><li><a href=#docker>Docker</a></li><li><a href=#k8s>K8s</a></li></ol></li><li><a href=#复制虚拟机>复制虚拟机</a></li></ol></li><li><a href=#网络配置>网络配置</a></li><li><a href=#集群初始化>集群初始化</a></li><li><a href=#ssh-配置可选>SSH 配置（可选）</a><ol><li><a href=#免密码登陆>免密码登陆</a></li><li><a href=#快捷连接>快捷连接</a></li></ol></li><li><a href=#参考>参考</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const customFont=document.createElement('link');customFont.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";customFont.type="text/css";customFont.rel="stylesheet";document.head.appendChild(customFont);}());</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-118341733-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-118341733-1');</script></body></html>